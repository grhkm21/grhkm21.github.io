<!DOCTYPE html>
<html lang="en-uk">
<title>Bernoulli Polynomials | Blog by grhkm21</title>
<meta charset="utf-8">
<meta name="generator" content="Hugo 0.109.0">
<meta name="description" content="Outlining what can be done on bernoulli polynomials in Lean">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="https://grhkm21.github.io/css/index.css">
<link rel="canonical" href="https://grhkm21.github.io/posts/bernoulli-polynomials/">
<link rel="alternate" type="application/rss+xml" href="" title="Blog by grhkm21">


<link rel="stylesheet" href="https://grhkm21.github.io/katex/katex.min.css">
<script defer src="https://grhkm21.github.io/katex/katex.min.js"></script>
<script defer src="https://grhkm21.github.io/katex/contrib/auto-render.min.js" onload="renderMathInElement(document.body)"></script>

<link rel="stylesheet" href="https://grhkm21.github.io/katex/katex.min.css">
<script defer src="https://grhkm21.github.io/katex/katex.min.js"></script>
<script defer src="https://grhkm21.github.io/katex/contrib/auto-render.min.js"></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
          
          
          delimiters: [
              {left: '$$', right: '$$', display: true},
              {left: '$', right: '$', display: false},
              {left: '\\(', right: '\\)', display: false},
              {left: '\\[', right: '\\]', display: true}
          ],
          
          throwOnError : false
        });
    });
</script>

<header>
  
    <a href="https://grhkm21.github.io/" class="title">Blog by grhkm21</a>
  
  
    <nav>
    
      <a href="/about-me/">About</a>
    
      <a href="/">Posts</a>
    
    </nav>
  
</header>

<article>
  <header>
    <h1>Bernoulli Polynomials</h1>
  </header>
  <p>Please note that $p$ does not denote a prime, but instead usually an integer $p \geq 0$.</p>
<h2 id="existing-lemmas">Existing lemmas</h2>
<p>Definition by recurrence:</p>
<p>$$
B_n = 1 - \sum_{k = 0}^{n - 1} \binom{n}{k} \frac{B_k}{n + 1 - k}
$$</p>
<p>$$
B_n(x) = \sum_{k = 0}^n \binom{n}{k} B_{n - k}x^k
$$</p>
<p>Faulhaber&rsquo;s theorem:</p>
<p>$$
\sum_{k = 0}^{n - 1} k^p = \sum_{i = 0}^p B_i \binom{p + 1}{i} \frac{n^{p + 1 - i}}{p + 1}
$$</p>
<p>Which has been formalised in Lean:</p>
<pre tabindex="0"><code class="language-lean" data-lang="lean">theorem sum_range_pow (n p : ℕ) :
  ∑ k in range n, (k : ℚ) ^ p =
    ∑ i in range (p + 1), bernoulli i * (p + 1).choose i * n ^ (p + 1 - i) / (p + 1) :=
</code></pre><p>Exponential Generating Function of Bernoulli numbers:</p>
<p>$$
\sum_{k = 0}^{\infty} \frac{B_k}{k!} t^k = \frac{t}{e^t - 1}
$$</p>
<p>Which has been formalised in Lean:</p>
<pre tabindex="0"><code class="language-lean" data-lang="lean">def bernoulli_power_series := mk $ λ n, algebra_map ℚ A (bernoulli n / n!)

theorem bernoulli_power_series_mul_exp_sub_one :
  bernoulli_power_series A * (exp A - 1) = X :=
</code></pre><p>We also have the following result:</p>
<p>$$
B_n(0) = (-1)^n B_n(1)
$$</p>
<p>Which has been formalised in Lean:</p>
<pre tabindex="0"><code class="language-lean" data-lang="lean">@[simp] lemma bernoulli_eval_zero (n : ℕ) : (bernoulli n).eval 0 = _root_.bernoulli n :=
@[simp] lemma bernoulli_eval_one (n : ℕ) : (bernoulli n).eval 1 = _root_.bernoulli&#39; n :=
def bernoulli (n : ℕ) : ℚ := (-1)^n * bernoulli&#39; n
</code></pre><h2 id="lemmas">Lemmas</h2>
<p>Below are lemmas that can to be proven:</p>
<p>Lemma (Exponential Generating Function of Bernoulli polynomials):</p>
<p>$$
\sum_{k = 0}^{\infty} \frac{B_k(x)}{k!} t^k = \frac{te^{tx}}{e^t - 1}
$$</p>
<p>Formalised as:</p>
<pre tabindex="0"><code class="language-lean" data-lang="lean">theorem bernoulli_generating_function (t : A) :
  mk (λ n, aeval t ((1 / n! : ℚ) • bernoulli n)) * (exp A - 1) =
    power_series.X * rescale t (exp A) :=
</code></pre><p>Lemma (Faulhaber&rsquo;s Theorem in terms of bernoulli polynomials): For integers $n \geq 1$ and $p \geq 0$,</p>
<p>$$
\sum_{k = 0}^{n - 1} k^p = \frac{B_{p + 1}(n) - B_{p + 1}}{p + 1}
$$</p>
<p>Formalised as:</p>
<pre tabindex="0"><code class="language-lean" data-lang="lean">lemma sum_range_pow_eq_bernoulli_sub (n p : ℕ) :
  (p + 1 : ℚ) * ∑ k in range n, (k : ℚ) ^ p = (bernoulli p.succ).eval n -
  (_root_.bernoulli p.succ) :=
</code></pre><p>Lemma (Derivative of Bernoulli polynomials): For integers $n \geq 1$,</p>
<p>$$
\frac{\mathrm{d}}{\mathrm{d}x} B_n(x) = nB_{n - 1}(x)
$$</p>
<p>Formalised as:</p>
<pre tabindex="0"><code class="language-lean" data-lang="lean">lemma derivative_bernoulli_add_one (k : ℕ) :
  (bernoulli (k + 1)).derivative = (k + 1) * bernoulli k :=
</code></pre><hr>
<h2 id="theorems">Theorems</h2>
<p>Theorem (Forward difference of bernoulli polynomials): For integers $n \geq 0$ and $p \geq 1$,</p>
<p>$$
B_p(n + 1) - B_p(n) = pn^{p - 1}
$$</p>
<p>Proof: We consider the exponential generating function of the forward difference:</p>
<p>$$
\begin{align*}
&amp;\sum_{n = 0}^{\infty} \left(B_n(x + 1) - B_n(x)\right) \frac{t^n}{n!} \\
&amp;= \left(\sum_{n = 0}^{\infty} B_n(x + 1) \frac{t^n}{n!}\right) - \left(\sum_{n = 0}^{\infty} B_n(x) \frac{t^n}{n!}\right) \\
&amp;= \frac{te^{t(x + 1)}}{e^t - 1} - \frac{te^{tx}}{e^t - 1} \\
&amp;= \frac{te^{tx}(e^t - 1)}{e^t - 1} \\
&amp;= te^{tx} \\
&amp;= \sum_{n = 0}^{\infty} x^n \frac{t^{n + 1}}{n!} \\
&amp;= \sum_{n = 1}^{\infty} nx^{n - 1} \frac{t^n}{n!} \\
\end{align*}
$$</p>
<hr>
<p>Theorem (Symmetry): For integers $n \geq 0$,</p>
<p>$$
B_n(x) = (-1)^n B_n(1 - x)
$$</p>
<p>Proof: Define the polynomial $E_n(x) = B_n(1 - x) - (-1)^n B_n(x)$. It suffices to show that $E_n(x) = 0$. We perform induction on $n$. For $n = 0$, it is so trivial that <code>simp</code> can probably do it. Assume it is true for $n = k$, then</p>
<p>$$
\begin{align*}
\frac{\mathrm{d}}{\mathrm{d}x} E_{k + 1}(x)
&amp;= -(k + 1)B_k(1 - x) - (-1)^{k + 1} (k + 1)B_k(x) \\
&amp;= -(k + 1)\left(B_k(1 - x) - (-1)^k B_k(x)\right) \\
&amp;= -(k + 1)E_k(x) \\
&amp;= 0
\end{align*}
$$</p>
<p>This means that $E_k(x)$ is constant. Finally, we know that $E_k(0) = B_n(1) - (-1)^n B_n(0) = 0$, finishing the proof.</p>
<hr>
<p>I have to go now, but this is what I am planning currently. I will check which lemmas are not implemented later, simply from the comment at the top of the file:</p>
<pre tabindex="0"><code class="language-lean" data-lang="lean">## TODO

- `bernoulli_eval_one_neg` : $$ B_n(1 - x) = (-1)^n B_n(x) $$
</code></pre><ul>
<li>Gareth</li>
</ul>

</article>





</html>
